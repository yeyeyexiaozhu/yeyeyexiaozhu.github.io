"use strict";(self["webpackChunkvue_3_2"]=self["webpackChunkvue_3_2"]||[]).push([[49],{2231:function(e,a,l){l.d(a,{JG:function(){return d},fT:function(){return n},hN:function(){return i},kV:function(){return u}});var t=l(9552);const i=()=>(0,t.Z)({url:"categories",method:"get"}),u=e=>(0,t.Z)({url:"categories",method:"post",data:e}),n=(e,a)=>(0,t.Z)({url:`categories/${e}`,method:"put",data:{cat_name:a}}),d=e=>(0,t.Z)({url:`categories/${e}`,method:"delete"})},4675:function(e,a,l){l.r(a),l.d(a,{default:function(){return Z}});var t=l(4350),i=(l(3241),l(1103),l(32)),u=(l(1154),l(1513)),n=(l(7),l(7534)),d=(l(2471),l(3632)),o=(l(4965),l(951)),c=(l(444),l(2040)),r=(l(9426),l(6252)),s=l(2262),m=l(3577),v=l(9963),p=l(2231),g=l(5781),_=l(3481),f=(l(2029),l(2759)),w=(l(9840),l(2443)),y=(l(6825),l(6589),l(3106)),k=(l(4367),l(9862)),h=l(1464),V=l(2124);const b={class:"dialog-footer"};var C={__name:"MyDialog",props:{dialogTitle:{required:!0,type:String,default:""},dialogTableVal:{type:String,required:!0,default:""},dialogCateVal:{type:Array,required:!0},cateId:{type:Number}},emits:["update:modelValue","initCateList"],setup(e,{emit:a}){const l=e,t=(0,s.iH)({catName:""}),i=(0,s.iH)(),u=(0,s.iH)([]),n=(0,s.iH)(null),d=(0,s.iH)(),c=(0,s.iH)({catName:[{required:!0,message:"Please input Activity name",trigger:"blur"}]}),m={expandTrigger:"hover",label:"cat_name",checkStrictly:!0,children:"children",value:"cat_id",emitPath:!1},v=()=>{a("update:modelValue",!1)},g=()=>{const e=e=>{(0,h.z8)({message:k.Z.global.t(e),type:"success",duration:1e3})};i.value.validate((async(i,u)=>{if(i){let i=0,u=0;const o=l.dialogTableVal===t.value.catName,c=t.value.catName;if("添加分类"===l.dialogTitle){if(n.value){const e=d.value.get(n.value);u=e.cat_id,i=e.cat_level+1}(0,p.kV)({cat_pid:u,cat_level:i,cat_name:c}).then((()=>e("message.addSuccess")))}else o||(0,p.fT)(l.cateId,c).then((()=>e("message.updateSuccess")));a("initCateList"),a("update:modelValue",!1)}else console.log("error submit!",u)}))};return(0,r.YP)((()=>l.dialogTableVal),(()=>{t.value.catName=l.dialogTableVal;const e=JSON.parse(JSON.stringify(l.dialogCateVal));e.forEach((e=>{e.children&&e.children.forEach((e=>{delete e.children}))}));const a=[...e,...(0,V.r)(e,1),...(0,V.r)(e,2)],i=new Map;a.forEach((e=>{i.set(e.cat_id,e)})),d.value=i,u.value=e}),{deep:!0,immediate:!0}),(a,l)=>{const d=y.EZ,s=f.nH,p=w.mg,k=f.ly,h=o.ElButton,V=_.d0;return(0,r.wg)(),(0,r.j4)(V,{"model-value":a.dialogVisible,title:e.dialogTitle,width:a.$store.getters.ifView?"50%":"80%","before-close":v},{footer:(0,r.w5)((()=>[(0,r._)("span",b,[(0,r.Wm)(h,{onClick:v},{default:(0,r.w5)((()=>[(0,r.Uk)("取消")])),_:1}),(0,r.Wm)(h,{type:"primary",onClick:g},{default:(0,r.w5)((()=>[(0,r.Uk)(" 确认 ")])),_:1})])])),default:(0,r.w5)((()=>[(0,r.Wm)(k,{model:t.value,"label-width":"90px",rules:c.value,ref_key:"formRef",ref:i},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{label:"分类名称",prop:"catName"},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{modelValue:t.value.catName,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.catName=e)},null,8,["modelValue"])])),_:1}),0!==u.value.length?((0,r.wg)(),(0,r.j4)(s,{key:0,label:"分类类型"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{options:u.value,props:m,clearable:"",modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value=e)},null,8,["options","modelValue"])])),_:1})):(0,r.kq)("",!0)])),_:1},8,["model","rules"])])),_:1},8,["model-value","title","width"])}}};const T=C;var H=T,N=l(7330),U=l(7257),W=l(7336);const q={class:"custom-tree-node"},S={style:{"margin-left":"8px"}},j={style:{"margin-left":"15px"}};var x={__name:"MyIndex",setup(e){const a=(0,N.QT)(),l={label:"cat_name",children:"children"},_=(0,s.iH)([]),f=(0,s.iH)(!1),w=(0,s.iH)(),y=(0,s.iH)({}),k=(0,s.iH)([]),h=(0,s.iH)(0),V=(0,s.iH)(!1),b=()=>{V.value=!0,(0,p.hN)().then((e=>{_.value=e,V.value=!1}))},C=async e=>{(0,U.A)((()=>(0,p.JG)(e)),(()=>b()),a)},T=(e,a)=>{f.value=!0,(0,W.F)(e)?(w.value="添加分类",y.value="",k.value=_.value):(w.value="修改分类",y.value=e,k.value=[],h.value=a)};return b(),(e,a)=>{const p=c.Dv,N=o.ElButton,U=d.dq,W=n.Ks,x=u.y,E=i.Kf,I=t.t;return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.wy)(((0,r.wg)(),(0,r.j4)(E,{class:"box-card"},{default:(0,r.w5)((()=>[(0,r.Wm)(U,{gutter:20,class:"header"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{span:7},{default:(0,r.w5)((()=>[(0,r.Uk)(" 商品分类 ")])),_:1}),(0,r.Wm)(N,{type:"primary",icon:(0,s.SU)(g.Plus),onClick:a[0]||(a[0]=e=>T())},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(e.$t("table.addCate")),1)])),_:1},8,["icon"])])),_:1}),(0,r.Wm)(x,{data:_.value,props:l},{default:(0,r.w5)((({node:e,data:a})=>[(0,r._)("span",q,[(0,r._)("span",S,[0===a.cat_level?((0,r.wg)(),(0,r.j4)(W,{key:0,type:"danger"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(a.cat_level)+"级分类",1)])),_:2},1024)):(0,r.kq)("",!0),1===a.cat_level?((0,r.wg)(),(0,r.j4)(W,{key:1,type:"warning"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(a.cat_level)+"级分类",1)])),_:2},1024)):(0,r.kq)("",!0),2===a.cat_level?((0,r.wg)(),(0,r.j4)(W,{key:2,type:"success"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,m.zw)(a.cat_level)+"级分类",1)])),_:2},1024)):(0,r.kq)("",!0),(0,r._)("span",j,(0,m.zw)(e.label),1)]),(0,r._)("span",null,[(0,r.Wm)(N,{type:"primary",icon:(0,s.SU)(g.Edit),onClick:(0,v.iM)((e=>T(a.cat_name,a.cat_id)),["stop"]),style:{"margin-right":"5px"}},null,8,["icon","onClick"]),(0,r.Wm)(N,{type:"danger",icon:(0,s.SU)(g.Delete),onClick:(0,v.iM)((e=>C(a.cat_id)),["stop"])},null,8,["icon","onClick"])])])])),_:1},8,["data"])])),_:1})),[[I,V.value]]),f.value?((0,r.wg)(),(0,r.j4)(H,{key:0,modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e),dialogTitle:w.value,dialogTableVal:y.value,dialogCateVal:k.value,cateId:h.value,onInitCateList:b},null,8,["modelValue","dialogTitle","dialogTableVal","dialogCateVal","cateId"])):(0,r.kq)("",!0)])}}},E=l(3744);const I=(0,E.Z)(x,[["__scopeId","data-v-1baab742"]]);var Z=I}}]);
//# sourceMappingURL=49.6a6ea877.js.map