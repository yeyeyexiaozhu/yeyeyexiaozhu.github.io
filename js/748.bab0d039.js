"use strict";(self["webpackChunkvue_3_2"]=self["webpackChunkvue_3_2"]||[]).push([[748],{4071:function(e,l,a){a.d(l,{rX:function(){return i},tr:function(){return r},wO:function(){return u},xb:function(){return o}});var t=a(9552);const o=()=>(0,t.Z)({url:"rights/tree",method:"get"}),u=()=>(0,t.Z)({url:"rights/list",method:"get"}),r=(e,l)=>(0,t.Z)({url:`roles/${e}/rights`,method:"post",data:{rids:l}}),i=(e,l)=>(0,t.Z)({url:`roles/${e}/rights/${l}`,method:"delete"})},8509:function(e,l,a){a.r(l),a.d(l,{default:function(){return G}});var t=a(4350),o=(a(3241),a(1103),a(32)),u=(a(1154),a(7921)),r=(a(626),a(9002)),i=(a(1010),a(363),a(7534)),n=(a(2471),a(6252)),s=a(3577),d=a(2262),p=a(5027),c=a(209);const g=(0,p.o8)({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:c.k,default:""},truncated:{type:Boolean},tag:{type:String,default:"span"}});var m=a(1446),v=a(1069),h=a(9143);const w=(0,n.aZ)({name:"ElText"}),y=(0,n.aZ)({...w,props:g,setup(e){const l=e,a=(0,v.Cd)(),t=(0,h.s3)("text"),o=(0,n.Fl)((()=>[t.b(),t.m(l.type),t.m(a.value),t.is("truncated",l.truncated)]));return(e,l)=>((0,n.wg)(),(0,n.j4)((0,n.LL)(e.tag),{class:(0,s.C_)((0,d.SU)(o))},{default:(0,n.w5)((()=>[(0,n.WI)(e.$slots,"default")])),_:3},8,["class"]))}});var f=(0,m.Z)(y,[["__file","/home/runner/work/element-plus/element-plus/packages/components/text/src/text.vue"]]),b=a(2123);const k=(0,b.nz)(f);var _=a(3632),V=(a(4965),a(951)),C=(a(444),a(2040)),z=(a(9426),a(3106)),S=(a(4367),a(7658),a(5781));const W=[{label:"",prop:""},{label:"roleName",prop:"roleName"},{label:"roleDesc",prop:"roleDesc"},{label:"id",prop:"id"},{label:"action",prop:"action",width:140}];var H=a(7336),D=a(3481),U=(a(2029),a(2759)),N=(a(9840),a(1513)),T=(a(7),a(6589),a(9552));const Z=()=>(0,T.Z)({url:"roles",method:"get"}),$=e=>(0,T.Z)({url:`roles/${e}`,method:"get"}),x=e=>(0,T.Z)({url:"roles",method:"post",data:e}),q=(e,l)=>(0,T.Z)({url:`roles/${e}`,method:"put",data:l}),j=e=>(0,T.Z)({url:`roles/${e}`,method:"delete"});var E=a(4071),K=a(9862),I=a(1464),R=a(2124);const O={class:"dialog-footer"};var Y={__name:"MyDialog",props:{dialogTitle:{required:!0,type:String,default:""},dialogTableVal:{type:Object,required:!0,default:()=>{}},rights:{type:Array,required:!0}},emits:["update:modelValue","initRoleList"],setup(e,{emit:l}){const a=e,t={children:"children",label:"authName"},o=(0,d.iH)(null),u=(0,d.iH)(null),r=(0,d.iH)([]),i=(0,d.iH)({roleName:"",roleDesc:""}),s=(0,d.iH)({roleName:[{required:!0,message:"Please input Activity name",trigger:"blur"}],roleDesc:[{required:!0,message:"Please input Activity name",trigger:"blur"}]}),p=(0,d.iH)(a.rights),c=()=>{l("update:modelValue",!1)},g=()=>{const e=()=>{(0,I.z8)({message:K.Z.global.t("message.updateSuccess"),type:"success",duration:1e3}),l("initRoleList"),l("update:modelValue",!1)};u.value.validate((async(l,t)=>{if(l){const l=o.value.getCheckedKeys(),t=[...l,...o.value.getHalfCheckedKeys()],u=t.join(","),n=a.dialogTableVal.id;"修改角色"===a.dialogTitle?(await q(n,i.value),l.toString()!==r.value.toString()&&(0,E.tr)(n,u).then((()=>e()))):"添加角色"===a.dialogTitle&&x(i.value).then((a=>{l.toString()!==r.value.toString()&&(0,E.tr)(a.roleId,u).then((()=>e()))}))}else console.log("error submit!",t)}))};return(0,n.YP)((()=>a.dialogTableVal),(()=>{const{roleName:e,roleDesc:l}=a.dialogTableVal;if(i.value.roleName=e,i.value.roleDesc=l,"修改角色"===a.dialogTitle){const e=(0,R.r)(a.dialogTableVal.children,2);e.forEach((e=>{r.value.push(e.id)}))}}),{deep:!0,immediate:!0}),(l,a)=>{const d=z.EZ,m=U.nH,v=N.y,h=U.ly,w=V.ElButton,y=D.d0;return(0,n.wg)(),(0,n.j4)(y,{"model-value":l.dialogVisible,title:e.dialogTitle,width:l.$store.getters.ifView?"50%":"80%","before-close":c},{footer:(0,n.w5)((()=>[(0,n._)("span",O,[(0,n.Wm)(w,{onClick:c},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1}),(0,n.Wm)(w,{type:"primary",onClick:g},{default:(0,n.w5)((()=>[(0,n.Uk)(" 确认 ")])),_:1})])])),default:(0,n.w5)((()=>[(0,n.Wm)(h,{model:i.value,"label-width":"90px",rules:s.value,ref_key:"formRef",ref:u},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{label:"角色名",prop:"roleName"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{modelValue:i.value.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value.roleName=e)},null,8,["modelValue"])])),_:1}),(0,n.Wm)(m,{label:"角色描述",prop:"roleDesc"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{modelValue:i.value.roleDesc,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value.roleDesc=e),type:"textarea"},null,8,["modelValue"])])),_:1}),(0,n.Wm)(m,{label:"权限设置",prop:"roleRight"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{ref_key:"treeRef",ref:o,data:p.value,"show-checkbox":"","node-key":"id","highlight-current":"",props:t,"default-checked-keys":r.value},null,8,["data","default-checked-keys"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["model-value","title","width"])}}};const A=Y;var L=A,P=a(7330),J=a(7257);const B={key:0},M={key:1,style:{padding:"15px"}};var F={__name:"MyIndex",setup(e){const l=(0,d.iH)({query:"",pagenum:1,pagesize:5}),a=(0,P.QT)(),p=(0,d.iH)(0),c=(0,d.iH)([]),g=(0,d.iH)(!1),m=(0,d.iH)(""),v=(0,d.iH)({}),h=(0,d.iH)(0),w=(0,d.iH)(0),y=(0,d.iH)(!1),f=()=>{y.value=!0,Z().then((e=>{const l=[];e.forEach((e=>{l.push(JSON.parse(JSON.stringify(e).replace(/roleId/g,"id")))})),h.value=l,p.value=l.length,c.value=N(h.value),y.value=!1}))},b=async()=>{const e=await(0,E.xb)();w.value=e},D=e=>{g.value=!0,(0,H.F)(e)?(m.value="添加角色",v.value={}):(m.value="修改角色",v.value=JSON.parse(JSON.stringify(e)))},U=async()=>{const e=await $(l.value.query);c.value=e},N=e=>{const a=(l.value.pagenum-1)*l.value.pagesize,t=l.value.pagenum*l.value.pagesize;return e.length<t?e.slice(a):e.slice(a,a+l.value.pagesize)},T=e=>{l.value.pagenum=1,l.value.pagesize=e,c.value=N(h.value)},x=e=>{l.value.pagenum=e,c.value=N(h.value)},q=e=>{(0,J.A)((()=>j(e.id)),(()=>f()),a)},K=(e,l)=>{(0,J.A)((()=>(0,E.rX)(l,e)),(()=>f()),a)};return f(),b(),(e,a)=>{const h=z.EZ,b=C.Dv,H=V.ElButton,N=_.dq,Z=k,$=i.Ks,j=r.$Y,E=r.eI,I=u.R,R=o.Kf,O=t.t;return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.wy)(((0,n.wg)(),(0,n.j4)(R,null,{default:(0,n.w5)((()=>[(0,n.Wm)(N,{gutter:20,class:"header"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{span:7},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{placeholder:e.$t("table.search"),clearable:"",modelValue:l.value.query,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value.query=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),(0,n.Wm)(H,{type:"primary",icon:(0,d.SU)(S.Search),onClick:U},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.$t("table.search")),1)])),_:1},8,["icon"]),(0,n.Wm)(H,{type:"primary",icon:(0,d.SU)(S.Plus),onClick:a[1]||(a[1]=e=>D())},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.$t("table.addrole")),1)])),_:1},8,["icon"])])),_:1}),(0,n.Wm)(E,{data:c.value,stripe:"",style:{width:"100%"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,d.SU)(W),((l,a)=>((0,n.wg)(),(0,n.j4)(j,{prop:l.prop,label:0!==a?e.$t(`table.${l.label}`):"",key:a,width:l.width,type:0===a?"expand":""},{default:(0,n.w5)((({row:e})=>["action"===l.prop?((0,n.wg)(),(0,n.iD)("span",B,[(0,n.Wm)(H,{type:"primary",icon:(0,d.SU)(S.Edit),onClick:l=>D(e)},null,8,["icon","onClick"]),(0,n.Wm)(H,{type:"danger",icon:(0,d.SU)(S.Delete),onClick:l=>q(e)},null,8,["icon","onClick"])])):""===l.prop?((0,n.wg)(),(0,n.iD)("div",M,[(0,n.Wm)(Z,{class:"mb-10",type:"primary",size:"large"},{default:(0,n.w5)((()=>[(0,n.Uk)("权限")])),_:1}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.children,(l=>((0,n.wg)(),(0,n.j4)(N,{key:l.id,class:"mb-4"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{type:"danger",class:"ml-2",closable:"",onClose:a=>K(l.id,e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(l.authName),1)])),_:2},1032,["onClose"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.children,(l=>((0,n.wg)(),(0,n.iD)("span",{key:l.id},[(0,n.Wm)($,{type:"warning",class:"ml-2",closable:"",onClose:a=>K(l.id,e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(l.authName),1)])),_:2},1032,["onClose"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.children,(l=>((0,n.wg)(),(0,n.j4)($,{key:l.id,type:"success",class:"ml-2",closable:"",onClose:a=>K(l.id,e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(l.authName),1)])),_:2},1032,["onClose"])))),128))])))),128))])),_:2},1024)))),128))])):(0,n.kq)("",!0)])),_:2},1032,["prop","label","width","type"])))),128))])),_:1},8,["data"]),(0,n.Wm)(I,{"current-page":l.value.pagenum,"onUpdate:currentPage":a[2]||(a[2]=e=>l.value.pagenum=e),"page-size":l.value.pagesize,"onUpdate:pageSize":a[3]||(a[3]=e=>l.value.pagesize=e),"page-sizes":[2,5,10,15],layout:"total, sizes, prev, pager, next, jumper",total:p.value,onSizeChange:T,onCurrentChange:x},null,8,["current-page","page-size","total"])])),_:1})),[[O,y.value]]),g.value?((0,n.wg)(),(0,n.j4)(L,{key:0,modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=e=>g.value=e),dialogTitle:m.value,onInitRoleList:f,dialogTableVal:v.value,rights:w.value},null,8,["modelValue","dialogTitle","dialogTableVal","rights"])):(0,n.kq)("",!0)])}}},X=a(3744);const Q=(0,X.Z)(F,[["__scopeId","data-v-1820b613"]]);var G=Q}}]);
//# sourceMappingURL=748.bab0d039.js.map